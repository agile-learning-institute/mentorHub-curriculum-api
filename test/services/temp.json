[
    {
        "$match": {
            "_id": "path_object_id"
        }
    },
    {
        "$unwind": "$segments"
    },
    {
        "$unwind": "$segments.topics"
    },
    {
        "$lookup": {
            "from": "topics_collection_name",
            "localField": "segments.topics.topic_id",
            "foreignField": "_id",
            "as": "topic_data"
        }
    },
    {
        "$unwind": "$topic_data"
    },
    {
        "$unwind": "$topic_data.resources"
    },
    {
        "$lookup": {
            "from": "resources_collection_name",
            "localField": "topic_data.resources",
            "foreignField": "_id",
            "as": "resource_data"
        }
    },
    {
        "$unwind": "$resource_data"
    },
    {
        "$project": {
            "name": 1,
            "segments.name": 1,
            "segments.topics.name": "$topic_data.name",
            "segments.topics.resources": {
                "name": "$resource_data.name",
                "link": "$resource_data.link"
            }
        }
    },
    {"$group": {
        "_id": "$_id",
        "name": {"$first": "$name"},
        "segments": {
            "$push": {
                "name": "$segments.name",
                "topics": {
                    "$push": {
                        "name": "$segments.topics.name",
                        "resources": {
                            "$push": {
                                "name": "$segments.topics.resources.name",
                                "link": "$segments.topics.resources.link"
                            }
                        }
                    }
                }
            }
        }
    }}
]