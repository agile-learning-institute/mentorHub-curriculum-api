version: "1.1"
name: Curriculum API Check
env:
  host: localhost:8088
config:
  loadTest:
    phases:
      - duration: 5
        arrivalRate: 50

tests:
  observable:
    name: Test Observability
    steps:
      - name: GET Config Values
        http:
          url: http://${{env.host}}/api/config/
          method: GET
          check:
            status: /200/
            schema:
              type: object
              properties:
                api_version:
                  type: string
                config_items:
                  type: array
                versions:
                  type: array
                enumerators:
                  type: object
              required:
                - api_version
                - config_items
                - versions
                - enumerators
              additionalProperties: false
      - name: GET Health
        http:
          url: http://${{env.host}}/api/health/
          method: GET
          check:
            status: /200/
  curriculum:
    name: Test get curriculum
    steps:
      - name: GET an existing curriculum
        http:
          url: http://${{env.host}}/api/curriculum/AAAA00000000000000000001/
          method: GET
          headers:
            Content-Type: application/json          
          check:
            status: /200/
            schema:
              type: object
              properties:
                method:
                  type: string
                  value: get_curriculum

      - name: Add a Resource to a Curriculum
        http:
          url: http://${{env.host}}/api/curriculum/AAAA00000000000000000001/
          method: POST
          headers:
            Content-Type: application/json
          json: 
            path: Test Path
          check:
            status: /200/
            schema:
              type: object
              properties:
                method:
                  type: string
                  value: create_curriculum

      - name: Update a Resource to a Curriculum
        http:
          url: http://${{env.host}}/api/curriculum/AAAA00000000000000000001/100/
          method: PATCH
          headers:
            Content-Type: application/json
          json: 
            path: Test Path
          check:
            status: /200/
            schema:
              type: object
              properties:
                method:
                  type: string
                  value: update_curriculum

      - name: Remove a Resource from a Curriculum
        http:
          url: http://${{env.host}}/api/curriculum/AAAA00000000000000000001/100/
          method: DELETE
          headers:
            Content-Type: application/json          
          check:
            status: /204/
